" ====================================================
" Basis-Konfiguration für eine Python-IDE in Vim
" ====================================================
" 
" Voraussetzungen:
"  - Vundle muss installiert sein (siehe GitHub: https://github.com/VundleVim/Vundle.vim)
"  - Verzeichnisse erstellen:
"       sudo apt install vim-gtk3  --Damit die zwischenablage Funktion 
"       mkdir -p ~/.vimundos/
"       mkdir -p ~/.vim/bundle
"       cd ~/.vim/bundle
"       git clone https://github.com/VundleVim/Vundle.vim.git
"
" Nach Anpassung dieser .vimrc: in Vim :PluginInstall ausführen. Anschließend beachte ->  Quick Start Anleitung: Installation aller Completer für YCM
" ====================================================

" ================================================================
" Quick Start Anleitung: Installation aller Completer für YCM
" ================================================================

"Installation:
" 1. Abhängigkeiten für CMake, Vim und Python installieren:
"    - Führe folgenden Befehl im Terminal aus:
"         apt install build-essential cmake vim-nox python3-dev mono-complete golang nodejs openjdk-17-jdk openjdk-17-jre npm
"Damit das richtig funktioniert musst du 
"	    cd ~/.vim/bundle/coc.nvim 
"	    npm install
"	    npm run build
"     :CocInstall coc-pyright 
"     coc-pyright ist die Unterstützung für python
" Hinweis:
"       Wenn du das in den Projekten verwenden willst musst du in
"       schnittstellenverzeichnis folgende datei unter
"       vb_bachstein/.vim/coc-settings.json mit dem Inhalt
" 
"{
"
" "inlayHint.enable": false,
" "python.inlayHints.variableTypes": false,
" "python.inlayHints.functionReturnTypes":false,
" "python.inlayHints.parameterNames.enabled": "none",
" "python.analysis.extraPaths": [
"  "../etl"
"  ],
"  "python.analysis.typeCheckingMode": "basic"
"}
" Dann findet er auch die ETL im verzeichnis drunter.
"
" Hinweis:
"    - Stelle sicher, dass alle notwendigen Pakete installiert sind, bevor Du YCM kompilierst.
"    - Nach dem Hinzufügen der Plugin-Einträge in der .vimrc, starte Vim und führe :PluginInstall aus.
"    - Weitere Informationen findest Du in der YCM-Dokumentation.
" ================================================================


" ---------------------------------------------------------------
" Erklärung zum Leader-Key in Vim:
" ---------------------------------------------------------------
" Der Leader-Key ist ein benutzerdefinierbarer Präfix, der genutzt wird, um
" eigene Tastenkombinationen (Mappings) zu definieren, ohne bestehende
" Vim-Kommandos zu überschreiben.
"
" Standardmäßig ist dieser Key auf den Backslash "\" gesetzt.
" Wichtig: Zum Suchen in Vim wird der Schrägstrich "/" verwendet, nicht der Backslash.
"
" Du kannst den Leader-Key in Deiner .vimrc ändern, falls Du den Backslash
" für andere Zwecke nutzen möchtest. Zum Beispiel:
" let mapleader = ","
" Damit wird das Komma (,) als Leader-Key genutzt.
"
" Beispiel-Mappings, die den Leader-Key verwenden:
"   - <leader>f (Standard: "\f", wenn Leader "\") öffnet den Fuzzy Finder (CtrlP).
"   - <leader>u (Standard: "\u") schaltet den Undo-Baum (Undotree) ein oder aus.
" ---------------------------------------------------------------

" ---------------------------
" Hinweise & Weitere Anpassungen
" ---------------------------
" YouCompleteMe:
"   - Beachte, dass YouCompleteMe separat kompiliert werden muss.
"   - Folge hierzu der Anleitung auf GitHub: https://github.com/Valloric/YouCompleteMe
"
" jedi-vim:
"   - Für optimale Python-Unterstützung empfiehlt sich der Einsatz von virtuellen Umgebungen.
"
" Vimspector:
"   - Erfordert ggf. zusätzliche Konfigurationsdateien (z.B. .vimspector.json) im Projektverzeichnis.
"
" CtrlP:
"   - Kann mit zusätzlichen Suchpfaden oder Ignorierregeln angepasst werden.
"
" Diese .vimrc stellt einen guten Ausgangspunkt dar. Gerne können wir gemeinsam weitere
" Funktionen und Plugins besprechen und einbinden, je nachdem, welche Anforderungen Du
" an Deine Python-Entwicklungsumgebung hast.
" ---------------------------
" Allgemeine Einstellungen
" ---------------------------
let mapleader = ","
syntax on
set autoindent                 " Automatisches Einrücken neuer Zeilen
set backspace=indent,eol,start " Backspace löscht normal
set clipboard=unnamedplus      " System-Clipboard verwenden
set encoding=utf-8             " UTF-8 als Standard-Encoding
set expandtab
set foldcolumn=1               " Zeige Faltspalte (bei Codefaltung)
set hidden                     " Erlaubt Bufferwechsel ohne Speichern
set hlsearch                  " Suchergebnisse hervorheben
set ignorecase		      " Bei der Suche wird nicht case sensitiv gesucht
set incsearch                 " Inkrementelle Suche
set mouse=a                   " Mausunterstützung aktivieren
set mousemodel=popup_setpos " Maus & GUI-like Verhalten
set nobackup                  " Keine Backup-Dateien erstellen
set nocompatible              " Deaktiviert den Kompatibilitätsmodus zu vi
set noerrorbells
set nowritebackup             " Keine Backup-Dateien beim Schreiben
set number                    " Absolute Zeilennummerierung
set relativenumber            " Relative Zeilennummerierung (gut zur Navigation)
set ruler
set scrolloff=7               " Immer 7 Zeilen Kontext beim Scrollen
set shiftwidth=4
set showmode                " Maus & GUI-like Verhalten
set sidescrolloff=8         " Sanftes Scrolling
set smartcase 	     	      " Beim Suchen wenn ein großbuchstabe eingegeben wird wieder case sensitiv gesucht.
set smartindent               " Intelligentes Einrücken
set tabstop=4
set termguicolors
set undodir=~/.vim/undo     " Undo-Historie
set undofile               " Undo-Historie
set visualbell    " Sanftes Scrolling
set whichwrap+=<,>,h,l,[,]     " Dafür sorgen das beim zeilenende automatisch auf angang der nächsten zeile  gewechselt wird
set wildmenu                  " Verbessertes Command-Line-Completion
colorscheme koehler 

" Automatisches Neuladen der .vimrc beim Speichern
autocmd! bufwritepost $MYVIMRC source %

" =============================================================================
" ---------------------------
" Vundle und Plugin-Konfiguration
" ---------------------------
" =============================================================================
" =============================================================================
filetype off                  " Temporäres Abschalten von Filetype-Plugins

" Vundle in den runtime path einbinden
set rtp+=~/.vim/bundle/Vundle.vim
call vundle#begin()
Plugin 'VundleVim/Vundle.vim' 
" --- Plugin-Liste ---
" NERDTree: Dateiexplorer für Vim
Plugin 'scrooloose/nerdtree'

" Das ist der Client für den Server mit dem man zu definition und Referencen
" springen kann
Plugin 'neoclide/coc.nvim', {'branch': 'release'}

" CtrlP: Fuzzy Finder zum schnellen Auffinden von Dateien
Plugin 'kien/ctrlp.vim'
" csv daten fromat hi set ft=csv oder set filetype=csv
Plugin 'mechatroner/rainbow_csv'
" Undotree: Erweiterte Undo-Funktionalität
Plugin 'mbbill/undotree'

" Git Plugin mit Blame und Git diff
Plugin 'https://github.com/tpope/vim-fugitive'

":Tabularize /, kannst du text mit fester Breite umformatieren
Plugin 'godlygeek/tabular'

" LeaderF: Fuzzy Finder mit Popup-Fenster
Plugin 'Yggdroot/LeaderF'

Plugin 'vim-airline/vim-airline'
Plugin 'vim-airline/vim-airline-themes'

call vundle#end()

" =============================================================================
" =============================================================================
" =============================================================================
" =============================================================================





filetype plugin indent on   " Aktiviert Filetype-Plugins und Auto-Indention


" ---------------------------------------------------------------
" LeaderF: Fuzzy Finder mit Popup-Fenster
" ---------------------------------------------------------------
" Wenn Du nicht nur nach Dateinamen, sondern auch nach Variablen, 
" Methoden oder anderen Inhalten in Deinem Projekt suchen möchtest,
" könnte LeaderF eine gute Wahl sein.
"
" LeaderF öffnet ein zentrales Popup-Fenster, in dem während des 
" Tippens die Suchergebnisse angezeigt werden. So findest Du schnell
" den gewünschten Code in Deinem Projekt.
"
" Installation:
"   - Mit Vundle fügst Du folgenden Plugin-Eintrag ein:
"         Plugin 'Yggdroot/LeaderF'
"
"   - Starte Vim und führe :PluginInstall aus.
"
" Standard-Mapping (Beispiel):
"     (z.B. "\f", wenn <leader> der Backslash "\" ist).
" ---------------------------------------------------------------
"   - Öffne LeaderF für die Dateisuche mit <leader>f 
nnoremap <leader>f :LeaderfFile<CR> 


" === Coc Keymaps verweissuche und definitionsuche ===
" Dann in Vim:
" gd → springt zur Definition
" gr → zeigt alle Referenzen (Quickfix)
" K → zeigt Hover-Info
" <C-Space> → IntelliSense-Vervollständigung
" nmap gd <Plug>(coc-definition) " Siehe weiter unten es wird ein neuer Tab
" geöffent
nmap gr <Plug>(coc-references)
nmap gi <Plug>(coc-implementation)
nnoremap K :call CocActionAsync('doHover')<CR>
inoremap <silent><expr> <C-Space> coc#refresh()
nmap [g <Plug>(coc-diagnostic-prev)
nmap ]g <Plug>(coc-diagnostic-next)
nmap <leader>q :copen<CR>
" Definition in neuem Tab
nnoremap gd :call CocActionAsync('jumpDefinition', 'tabe')<CR>

" Definition im Vertikal-Split
nnoremap gD :call CocActionAsync('jumpDefinition', 'vsplit')<CR>

" Definition: springe zu bereits geöffnetem Tab/Window, sonst öffnen
nnoremap gX :call CocActionAsync('jumpDefinition', 'drop')<CR>
" ---------------------------
" Benutzerdefinierte Tastenkürzel
" ---------------------------

" Rechtschreibprüfung (F12 speichert, prüft mit aspell auf Deutsch, lädt die Datei neu)
nnoremap <F12> :w!<CR>:!aspell --lang=de check %<CR>:e! %<CR>

" NERDTree:
" - F2: Schnelles Ein-/Ausblenden des Dateiexplorers
nnoremap <F2> :NERDTreeToggle<CR>
" - Im NERDTree-Puffer: Mit <C-o> zum zuletzt besuchten Ort springen
autocmd FileType nerdtree nmap <buffer> <C-o> go

" F3: Zum Durchschalten der Tabs (nächster Tab)
nnoremap <F3> :tabnext<CR>

" F4: Zum Durchschalten der Fenster (Splits)
nnoremap <F4> <C-w>w

" F5: Zum Durchschalten der offenen Buffer im aktuellen Fenster
nnoremap <F5> :bnext<CR>

" -----------------------------------------------------------------
" CtrlP: Öffnet den Fuzzy Finder.
" Mit diesem Mapping wird <leader>f genutzt, wobei <leader> ein 
" konfigurierbarer Präfix ist (Standard: "\"), der Dir ermöglicht,
" eigene Tastenkürzel zu definieren.
" Beispiel: Wenn mapleader auf "\" gesetzt ist, aktivierst Du CtrlP
" mit "\f". Du kannst den Leader-Key in Deiner .vimrc anpassen.
" -----------------------------------------------------------------
" nnoremap <leader>f :CtrlP<CR>

" -----------------------------------------------------------------
" Undotree: Blendet den Undo-Baum ein oder aus.
" Dieses Mapping nutzt <leader>u, um den Undo-Baum zu öffnen oder zu schließen.
" <leader> ist hier ebenfalls ein konfigurierbarer Präfix (Standard: "\").
" Somit öffnest Du den Undo-Baum standardmäßig mit "\u". 
" Denke daran, dass Du den Leader-Key nach Deinen Wünschen konfigurieren kannst.
" -----------------------------------------------------------------
nnoremap <leader>u :UndotreeToggle<CR>

" Vimspector: Debugging-Steuerung
" - F9: Debugging starten/fortsetzen
nmap <F9> <Plug>VimspectorContinue
" (Weitere Vimspector-Mappings können nach Bedarf ergänzt werden)

" vim-slime: Konfiguration, um Code an IPython (in tmux) zu senden
" let g:slime_target = "tmux"
" Optional: Weitere Einstellungen für vim-ipython-cell findest Du in der Plugin-Dokumentation

" Folgender Code sorgt dafür das man im Text über zeilenumbrüche mit hoch und
" runter natürlich mit dem feiltasen über zeilenumbrüchen arbeiten kann
" Normale Bewegung durch visuelle Zeilen im Normal-, Visual- und
" Operator-Pending Mode
 nnoremap j gj
 nnoremap k gk
 vnoremap j gj
 vnoremap k gk
 onoremap j gj
 onoremap k gk
"
" " Pfeiltasten im Normal-, Visual- und Operator-Pending Mode
 nnoremap <Down> gj
 nnoremap <Up> gk
 vnoremap <Down> gj
 vnoremap <Up> gk
 onoremap <Down> gj
 onoremap <Up> gk

" Hier wird dafür gesorgt das eine Textvorschlag mit Enter angenommen werden
" kann.
inoremap <silent><expr> <CR> coc#pum#visible() ? coc#pum#confirm() : "\<CR>"
inoremap <silent><expr> <TAB>  coc#pum#visible() ? coc#pum#next(1) : "\<TAB>"

inoremap <silent><expr> <S-TAB>  coc#pum#visible() ? coc#pum#prev(1) : "\<C-h>"
" " Pfeiltasten im Insert Mode (bleibt im Insert Mode!)
 inoremap <Down> <C-o>gj
 inoremap <Up> <C-o>gk
 nnoremap <leader>t :tab split<CR>



" ============================
" vscode.vimrc – Verhalten wie VS Code
" ============================

" Direkt in den Insert-Modus starten
" autocmd VimEnter * startinsert

" ESC schließt Insert-Modus nicht sofort (nur per Ctrl-[)
" inoremap <Esc> <Nop>


" Copy/Paste wie VS Code
" (Achtung: Terminal muss Ctrl+Shift-C/V an Vim weitergeben)
tnoremap <C-S-v> <C-\><C-n>"+p
inoremap <C-S-v> <C-R>+
cnoremap <C-S-v> <C-R>+
vnoremap <C-S-c> "+y
vnoremap <C-S-x> "+d
vnoremap <C-S-v> "+p
nnoremap <C-S-v> "+p
nnoremap <C-S-c> "+y
nnoremap <C-S-x> "+d
vnoremap <C-c> "+y

" Das direkt zum suchen das ist <C-/> das komische rote dings
inoremap  <Esc>/ 

" --- Shift + Pfeiltasten markiert Text auch im Insert-Modus ---
inoremap <S-Left>  <Esc>v<Left>
inoremap <S-Right> <Esc><Right>v<Right>
inoremap <S-Up>    <Esc>v<Up>
inoremap <S-Down>  <Esc>v<Down>


" ===== Zeilen/Blöcke verschieben wie VS Code (Alt+Up/Alt+Down) =====
" Normal mode: aktuelle Zeile, danach wieder an die Schreibposition zurück
nnoremap <A-Down> <Esc>:m .+1<CR>==gi
nnoremap <A-Up>   <Esc>:m .-2<CR>==gi

" Insert mode: aktuelle Zeile, danach wieder an die Schreibposition zurück
inoremap <A-Down> <Esc>:m .+1<CR>==gi
inoremap <A-Up>   <Esc>:m .-2<CR>==gi

" Visual mode: markierten Block verschieben (Markierung beibehalten)
vnoremap <A-Down> :m '>+1<CR>gv=gv
vnoremap <A-Up>   :m '<-2<CR>gv=gv

" Insert mode: Zeile, danach an alte Schreibposition zurück
inoremap <C-S-Down> <Esc>:t.<CR>==gi




nnoremap <C-l> :nohlsearch<CR>

" Fenster einfach wechseln (Ctrl + Pfeile)
nnoremap <C-Left>  <C-w>h
nnoremap <C-Down>  <C-w>j
nnoremap <C-Up>    <C-w>k
nnoremap <C-Right> <C-w>l

" Einfaches Speichern/Beenden
nnoremap <C-s> :w<CR>
inoremap <C-s> <Esc>:w<CR>a
" nnoremap <C-S-q> :q<CR>
"

" <C-y> zum schnellen Beenden von Vim
nnoremap <C-y> :q<CR>
inoremap <C-y> <Esc>:q<CR>
vnoremap <C-y> <Esc>:q<CR> 
nnoremap <C-a> gg<S-v>G
inoremap <C-a> <ESC>gg<S-v>G
